# CVE-2025-6545 Vulnerability Research

**Research Date:** 2025-06-25  
**CVE ID:** CVE-2025-6545

## Executive Summary

CVE-2025-6545 is a **CRITICAL** vulnerability in the pbkdf2 npm package that affects cryptographic key derivation. The vulnerability allows signature spoofing through improper input validation, where the library silently returns predictable zero-filled or uninitialized memory instead of proper cryptographic keys when using non-normalized or unsupported hash algorithms. This completely compromises the security of any cryptographic operations relying on the affected key derivation.

## Vulnerability Details

### Basic Information
- **CVE ID:** CVE-2025-6545
- **Publication Date:** 2025-06-23T19:15:25.220Z
- **Last Modified:** 2025-06-23T20:16:21.633Z
- **Status:** Awaiting Analysis (NVD), Published (CVE.org)
- **Source Identifier:** 7ffcee3d-2c14-4c3e-b844-86c6a321a158 (Harborist)

### Technical Details
- **Vulnerability Type:** Improper Input Validation / Signature Spoofing
- **CWE Classification:** CWE-20 (Improper Input Validation)
- **CVSS v4.0 Score:** 9.1 (CRITICAL)
- **CVSS v4.0 Vector:** `CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:L/VI:H/VA:N/SC:H/SI:H/SA:H`
- **CAPEC ID:** CAPEC-475 (Signature Spoofing by Improper Validation)

### Affected Software
- **Vendor:** Browserify Community
- **Product:** pbkdf2 (npm package)
- **Package URL:** https://npmjs.com/pbkdf2
- **Repository:** https://github.com/browserify/pbkdf2
- **Affected Versions:** 3.0.10 through 3.1.2 (inclusive)
- **Affected File:** `lib/to-buffer.js`
- **Fixed Versions:** 3.1.3+ (patched)

### Impact Assessment
- **Confidentiality Impact:** LOW (direct), HIGH (subsequent systems)
- **Integrity Impact:** HIGH
- **Availability Impact:** NONE (direct)
- **Attack Vector:** NETWORK
- **Attack Complexity:** LOW
- **Attack Requirements:** PRESENT
- **Privileges Required:** NONE
- **User Interaction:** NONE
- **Scope:** Changed (affects downstream systems)

### Disclosure Timeline
- **CVE Reserved:** 2025-06-23T18:39:39.611Z
- **CVE Published:** 2025-06-23T18:41:18.771Z
- **CVE Updated:** 2025-06-23T19:26:40.223Z
- **GitHub Advisory:** 2025-06-23T22:41:50Z
- **Discovery:** External researcher
- **Patch Available:** Yes (commit e3102a8cd4830a3ac85cd0dd011cc002fdde33bb)

### Technical Description

The vulnerability exists in the pbkdf2 library's handling of hash algorithm names. The library only properly supports a limited set of literal algorithm names:
- `'md5'`, `'sha1'`, `'sha224'`, `'sha256'`, `'sha384'`, `'sha512'`, `'rmd160'`, `'ripemd160'`

**Vulnerable Scenarios:**
1. **Non-normalized algorithms:** Variations like `'SHA-1'`, `'sha-256'`, `'SHA512'`, `'Sha256'`
2. **Unsupported algorithms:** Modern algorithms like `'sha3-256'`, `'sha3-512'`, `'blake2b512'`

**Impact by Environment:**
- **Browsers:** Returns zero-filled buffers (completely predictable)
- **Node.js with pbkdf2/browser:** Returns uninitialized memory (unpredictable but still compromised)
- **Bun:** Returns uninitialized memory for both `pbkdf2` and `pbkdf2/browser` imports

**Root Cause:** The vulnerability was introduced in commit `9699045c37a07f8319cfb8d44e2ff4252d7a7078` where improper input validation allows the function to silently fail and return predictable output instead of throwing an error or properly processing the algorithm.

### Proof of Concept

```javascript
const node = require('crypto')
const polyfill = require('pbkdf2/browser')

const algos = [
  'sha3-512', 'sha3-256', 'SHA3-384',
  'Sha256', 'Sha512', 'sha512-256',
  'SHA1', 'sha-1',
  'blake2b512',
  'RMD160', 'RIPEMD-160', 'ripemd-160',
]

for (const algo of algos) {
  for (const { pbkdf2Sync } of [node, polyfill]) {
    const key = pbkdf2Sync('secret', 'salt', 100000, 64, algo)
    console.log(`${algo}: ${key.toString('hex')}`);
  }
}
```

**Expected vs Actual Output:**
- Node.js crypto: Proper cryptographic keys
- pbkdf2 polyfill: All zeros (`00000000000000000000000000000000...`)

### Affected Environments

1. **Bundled Applications:** Webpack, Vite, Rollup with crypto polyfills
2. **Browser Polyfills:** crypto-browserify, node-libs-browser, vite-plugin-node-polyfills
3. **Node.js:** Only when explicitly using `require('pbkdf2/browser')`
4. **Bun Runtime:** Both `require('pbkdf2')` and `require('pbkdf2/browser')`

### Mitigation and Remediation

#### Immediate Actions
1. **Update pbkdf2:** Upgrade to version 3.1.3 or later
2. **Audit Usage:** Check if your code or dependencies use affected algorithm names
3. **Key Rotation:** If affected algorithms were used, rotate all derived keys
4. **Review Dependencies:** Check for packages that re-export pbkdf2 functionality

#### Long-term Recommendations
1. **Use Native Crypto:** Prefer `crypto.subtle` in browsers and native Node.js crypto
2. **Algorithm Validation:** Implement explicit algorithm validation
3. **Testing:** Add tests for algorithm name variations
4. **Monitoring:** Monitor for usage of non-standard algorithm names

#### Detection Script
```javascript
// Check if your code might be affected
const affectedAlgos = [
  'sha3-512', 'sha3-256', 'SHA3-384', 'Sha256', 'Sha512', 
  'sha512-256', 'SHA1', 'sha-1', 'blake2b512', 'RMD160', 
  'RIPEMD-160', 'ripemd-160'
];

// Search your codebase for these patterns
```

### Security Implications

1. **Cryptographic Failure:** Complete compromise of key derivation security
2. **Authentication Bypass:** Predictable keys can be used to forge signatures
3. **Data Exposure:** Encrypted data may be easily decryptable
4. **Supply Chain Risk:** Affects any application using crypto polyfills
5. **Silent Failure:** No error indication makes detection difficult

### References

- **CVE Entry:** https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-6545
- **NVD Entry:** https://nvd.nist.gov/vuln/detail/CVE-2025-6545
- **GitHub Advisory:** https://github.com/browserify/pbkdf2/security/advisories/GHSA-h7cp-r72f-jxh6
- **Patch Commit:** https://github.com/browserify/pbkdf2/commit/e3102a8cd4830a3ac85cd0dd011cc002fdde33bb
- **Vulnerable Commit:** https://github.com/browserify/pbkdf2/commit/9699045c37a07f8319cfb8d44e2ff4252d7a7078
- **Package Repository:** https://github.com/browserify/pbkdf2
- **NPM Package:** https://npmjs.com/pbkdf2

### Research Metadata
- **Sources Consulted:** NVD, CIRCL CVE Search, GitHub Security Advisory
- **Research Tools:** CVE databases, GitHub API, npm registry
- **Verification Status:** Confirmed across multiple sources
- **Last Verified:** 2025-06-25T17:07:14Z

---
*Comprehensive research conducted on 2025-06-25 by automated vulnerability analysis*