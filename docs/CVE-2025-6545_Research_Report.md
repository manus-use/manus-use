# CVE-2025-6545 Comprehensive Research Report

## Executive Summary

CVE-2025-6545 is a **Critical** severity vulnerability in the pbkdf2 npm package that affects versions 3.0.10 through 3.1.2. The vulnerability allows for signature spoofing through improper input validation, causing the library to silently return predictable uninitialized or zero-filled memory for non-normalized or unimplemented algorithm strings.

## Vulnerability Details

### CVE Information
- **CVE ID**: CVE-2025-6545
- **CVSS Score**: 9.1 (Critical)
- **CVSS Vector**: CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:L/VI:H/VA:N/SC:H/SI:H/SA:H
- **CWE**: No CWEs assigned
- **Publication Date**: June 23, 2025
- **Assigning CNA**: Harborist

### Affected Package
- **Package**: pbkdf2 (npm)
- **Affected Versions**: >=3.0.10 <=3.1.2
- **Patched Versions**: >= 3.1.3

### Technical Description

The vulnerability stems from improper input validation in the pbkdf2 library's handling of algorithm strings. The issue affects two categories of algorithms:

1. **Unsupported algorithms** (e.g., `sha3-256`, `sha3-512`, `sha512-256`)
2. **Supported but non-normalized algorithms** (e.g., `Sha256`, `Sha512`, `SHA1`, `sha-1`, `sha-256`, `sha-512`)

While these algorithms work correctly in Node.js, the pbkdf2 polyfill silently returns highly predictable output instead of proper cryptographic results.

### Vulnerability Mechanism

The vulnerability manifests differently across environments:

- **Node.js with `pbkdf2/browser` import**: Returns uninitialized memory (using `Buffer.allocUnsafe`)
- **Bun with `pbkdf2` import**: Returns uninitialized memory with sparse flipped bytes
- **Browsers**: Returns zero-filled buffers

### Safe Algorithm Strings

Only the following literal algorithm strings were **NOT** affected:
- `'md5'`
- `'sha1'`
- `'sha224'`
- `'sha256'`
- `'sha384'`
- `'sha512'`
- `'rmd160'`
- `'ripemd160'`

Any other algorithm representations, including case variations or different formats, were vulnerable.

## CVSS v4 Analysis

### Exploitability Metrics
- **Attack Vector**: Network (AV:N)
- **Attack Complexity**: Low (AC:L)
- **Attack Requirements**: Present (AT:P)
- **Privileges Required**: None (PR:N)
- **User Interaction**: None (UI:N)

### Vulnerable System Impact
- **Confidentiality**: Low (VC:L)
- **Integrity**: High (VI:H)
- **Availability**: None (VA:N)

### Subsequent System Impact
- **Confidentiality**: High (SC:H)
- **Integrity**: High (SI:H)
- **Availability**: High (SA:H)

## Affected Environments

### Direct Impact
- **Bundled code** (Webpack, Vite, etc.): Affects `require('crypto')` and `require('pbkdf2')`
- **Node.js**: Affects `require('pbkdf2/browser')` but NOT `require('pbkdf2')` or `require('crypto')`
- **Bun**: Affects both `require('pbkdf2')` and `require('pbkdf2/browser')`

### Polyfill Impact
The vulnerability affects `require('crypto')` in polyfilled environments from:
- `crypto-browserify`
- `node-libs-browser`
- `vite-plugin-node-polyfills`
- `node-stdlib-browser`
- Other crypto polyfill packages

## Proof of Concept

```javascript
const node = require('crypto')
const polyfill = require('pbkdf2/browser')

const algos = [
  'sha3-512', 'sha3-256', 'SHA3-384',
  'Sha256', 'Sha512', 'sha512-256',
  'SHA1', 'sha-1',
  'blake2b512',
  'RMD160', 'RIPEMD-160', 'ripemd-160',
]

for (const algo of algos) {
  for (const { pbkdf2Sync } of [node, polyfill]) {
    const key = pbkdf2Sync('secret', 'salt', 100000, 64, algo)
    console.log(`${algo}: ${key.toString('hex')}`);
  }
}
```

**Expected Output Pattern**:
- Odd lines (Node.js): Proper cryptographic output
- Even lines (pbkdf2 polyfill): All zeros (`00000000...`)

## Security Impact

### Critical Implications
1. **Cryptographic Failure**: Applications using affected algorithm strings generate predictable keys instead of secure cryptographic material
2. **Silent Failure**: The vulnerability operates silently without error messages, making detection difficult
3. **Key Compromise**: Zero-filled or predictable keys completely compromise security assumptions
4. **Authentication Bypass**: Compromised key derivation can lead to authentication system failures

### Real-World Scenarios
- Password-based encryption systems using non-standard algorithm names
- Key derivation for session tokens or API keys
- Cryptographic protocols relying on PBKDF2 with case-variant algorithm specifications
- Applications migrating from Node.js to browser environments

## Remediation

### Immediate Actions
1. **Update to version 3.1.3 or later** of the pbkdf2 package
2. **Audit existing implementations** for use of non-standard algorithm strings
3. **Review generated keys** from affected versions for potential compromise
4. **Rotate compromised keys** if vulnerability was exploited

### Long-term Recommendations
1. **Avoid Node.js crypto polyfills** when targeting non-Node.js environments
2. **Use `crypto.subtle`** and modern cryptography primitives for browser applications
3. **Implement algorithm validation** to ensure only supported, normalized algorithm names are used
4. **Add cryptographic output validation** to detect zero-filled or predictable results

## Detection and Monitoring

### Indicators of Compromise
- Zero-filled cryptographic outputs in logs
- Predictable key patterns in encrypted data
- Authentication failures with valid credentials
- Unusual patterns in derived key material

### Audit Checklist
- [ ] Identify all uses of pbkdf2 package in codebase
- [ ] Check for non-standard algorithm string usage
- [ ] Verify pbkdf2 package version in all environments
- [ ] Review bundler configurations for crypto polyfills
- [ ] Test key derivation outputs for predictability

## References

### Primary Sources
- [GitHub Security Advisory GHSA-h7cp-r72f-jxh6](https://github.com/browserify/pbkdf2/security/advisories/GHSA-h7cp-r72f-jxh6)
- [CVE-2025-6545 MITRE Entry](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-6545)

### Fix Commits
- [Primary Fix Commit](https://github.com/browserify/pbkdf2/commit/9699045c37a07f8319cfb8d44e2ff4252d7a7078)
- [Additional Fix Commit](https://github.com/browserify/pbkdf2/commit/e3102a8cd4830a3ac85cd0dd011cc002fdde33bb)

### Credits
- **Reporter**: ChALkeR
- **Remediation Developer**: ljharb

## Timeline

- **June 23, 2025**: CVE assigned and published
- **June 23, 2025**: GitHub Security Advisory published
- **June 23, 2025**: Fix commits merged

## Conclusion

CVE-2025-6545 represents a critical cryptographic vulnerability that can silently compromise application security. The predictable output from key derivation functions can lead to complete security failures in affected applications. Organizations should prioritize updating to the patched version and auditing their cryptographic implementations for potential exposure.

The vulnerability highlights the importance of proper input validation in cryptographic libraries and the risks associated with polyfilling Node.js crypto functionality in browser environments.

---

*Report generated on: December 25, 2024*
*Research conducted by: AI Security Analyst*